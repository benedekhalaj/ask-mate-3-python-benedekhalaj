{% extends "layout.html" %}
{% block title %}
    List questions
{% endblock %}

{% block content %}
    {% block back %}
    {% endblock %}
    <h2>Questions</h2>

    <form action="{{ url_for('search_question') }}">
        <label for="search">Search:</label>
        <input id="search" name="q" type="text">
        <button type="submit">Search</button>
    </form>

    <p><a href="/add-question">Add new question</a></p>

    {% block highlight %}
    <table>
        <tr>
            {% for title in titles %}
                {% if title in ['submission_time', 'view_number', 'vote_number', 'title', 'message', 'image'] %}
                    <th>
                        <a href="/list?order_by={{ title }}&order_direction=asc">▲</a>
                        {{  title.replace('_', ' ').capitalize() }}
                        <a href="/list?order_by={{ title }}&order_direction=desc">▼</a>
                    </th>
                {% endif %}
            {% endfor %}
        </tr>

        {% for question in questions %}
            <tr>
            {% for title, value in question.items() %}
                {% if title in ['submission_time', 'view_number', 'vote_number', 'title', 'message', 'image'] %}
                    {% if title == 'title' %}
                        <td style="text-align: center; height: 50px;"><a href="/question/{{ question['id'] }}/view">{{ value }}</a></td>
                    {% elif title == 'image' %}
                        {% if value %}
                            <td><a href="{{ url_for('static', filename=value) }}" target="_blank"><img src="{{ url_for('static',filename=value) }}" style="max-height: 50px;"></a></td>
                        {% else %}
                            <td><p>No image</p></td>
                        {% endif %}
                    {% else %}
                        <td style="text-align: center; height: 50px;">{{ value }}</td>
                    {% endif %}
                {% endif %}
            {% endfor %}
                <td><a href="/question/{{ question['id'] }}/vote_up">Vote up</a></td>
                <td><a href="/question/{{ question['id'] }}/vote_down">Vote down</a></td>
            </tr>
        {% endfor %}
    </table>

        {% endblock %}

    {% if main_page %}
        <a href="/list">All question</a>
    {% endif %}
{% endblock %}